let titleEl=document.querySelector(".title"),liquipediaEl=document.querySelector(".liquipedia"),nextEl=document.querySelector(".next"),expansionEl=document.querySelector(".expansion"),downloadEl=document.querySelector(".download"),playerEl=document.querySelectorAll(".player"),loadingEl=document.querySelector(".loading"),historyEl=document.querySelector(".history.spoiler"),thumbnailEl=document.querySelector(".stream-thumbnail"),updatePanel=e=>{if(e.error)return loadingEl.classList.remove("hide-top"),void(loadingEl.textContent=`ERROR: ${e.error}`);if("live"===e.stream.type){let t;if(loadingEl.classList.add("hide-top"),createEl("a","",{href:"https://twitch.tv/scvodarchives",rel:"noopener noreferrer",target:"_blank"},[],document.querySelectorAll(".stream-thumbnail")[0]),createEl("img","",{title:e.stream.title,src:e.stream.thumbnail.replace(/{width}/,"250").replace(/{height}/,"141")},["thumbnail"],document.querySelectorAll(".stream-thumbnail > a")[0]),createEl("span","ðŸ”´",null,["stream-thumbnail-live"],document.querySelectorAll(".stream-thumbnail")[0],!0),createEl("span","Playing:",null,["item-title"],titleEl),t=document.createTextNode(` ${e.title}`),titleEl.appendChild(t),createEl("span","Liquipedia:",null,["item-title"],liquipediaEl),createEl("a","",{href:e.liquipedia,rel:"noopener noreferrer",target:"_blank"},[],liquipediaEl),createEl("img"," ",{title:"Liquipedia",src:"https://starcraftvods.com/images/liquipedia.png"},["icon"],document.querySelectorAll(".liquipedia > a")[0]),createEl("span","Next Match:",null,["item-title"],nextEl),t=document.createTextNode(` ${e.next}`),nextEl.appendChild(t),createEl("span","Expansion:",null,["item-title"],expansionEl),t=document.createTextNode(` ${e.expansion.fullName}`),expansionEl.appendChild(t),!1!==e.download&&(createEl("span","Download Tournament:",null,["item-title"],downloadEl),createEl("a"," Magnet Link",{href:`https://starcraftvods.com/dl/?${e.download.short_code}`,rel:"noopener noreferrer",target:"_blank"},[],downloadEl)),Boolean(e.gstl))return playerEl[0].innerHTML="GSTL VODs don't have player data.",void document.querySelector(".item.history").remove();let a=0;for(var l in e.aligulac)if(e.aligulac.hasOwnProperty(l)){if("history"===l)continue;if(e.aligulac[l].hasOwnProperty("error")){createEl("div",e.aligulac[l].error,null,["player-ign"],playerEl[a]);continue}createEl("div",e.aligulac[l].tag,null,["player-ign"],playerEl[a]),createEl("img","",{src:`https://starcraftvods.com/images/flags/${e.aligulac[l].country}.png`,title:e.aligulac[l].country},["icon"],document.querySelectorAll(".player-ign")[a]),createEl("img","",{src:`https://starcraftvods.com/images/${e.aligulac[l].race}.png`,title:"Z"===e.aligulac[l].race?"Zerg":"T"===e.aligulac[l].race?"Terran":"P"===e.aligulac[l].race?"Protoss":""},["icon"],document.querySelectorAll(".player-ign")[a]),createEl("div",e.aligulac[l].name,null,["player-name"],playerEl[a]),createEl("span","Name: ",null,["player-title"],document.querySelectorAll(".player-name")[a],!0),e.aligulac[l].romanized_name&&createEl("div",e.aligulac[l].romanized_name,"",["player-romanized"],playerEl[a]),createEl("span","Romanized: ",null,["player-title"],document.querySelectorAll(".player-romanized")[a],!0),createEl("div",null!==e.aligulac[l].birthday?e.aligulac[l].birthday:"Unknown",null,["player-birthday"],playerEl[a]),createEl("span","Birthday: ",null,["player-title"],document.querySelectorAll(".player-birthday")[a],!0),createEl("div",`$${e.aligulac[l].total_earnings.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`,null,["player-earnings"],playerEl[a]),createEl("span","Earnings: ",null,["player-title"],document.querySelectorAll(".player-earnings")[a],!0),createEl("div","",null,["player-liquipedia"],playerEl[a]),createEl("a","Liquipedia",{href:`https://liquipedia.net/starcraft2/${e.aligulac[l].lp_name?e.aligulac[l].lp_name:e.aligulac[l].tag}`,rel:"noopener noreferrer",target:"_blank"},[],document.querySelectorAll(".player-liquipedia")[a],!0),createEl("div","",null,["player-aligulac"],playerEl[a]),createEl("a","Aligulac",{href:`http://aligulac.com/players/${e.aligulac[l].id}`,rel:"noopener noreferrer",target:"_blank"},[],document.querySelectorAll(".player-aligulac")[a],!0),a++}if(e.aligulac.history.hasOwnProperty("error"))history="NO MATCH HISTORY FOUND OR BAD DATA.";else{for(let l=0;l<=4;l++)if(e.aligulac.history.objects[l]){createEl("span",`${e.aligulac.history.objects[l].eventobj.fullname} (${e.aligulac.history.objects[l].date})`,null,[],historyEl),createEl("br","",null,[],historyEl);let t=document.createTextNode(e.aligulac.history.objects[l].pla.tag);historyEl.appendChild(t),createEl("img","",{src:`https://starcraftvods.com/images/${e.aligulac.history.objects[l].rca}.png`,title:"Z"===e.aligulac.history.objects[l].rca?"Zerg":"T"===e.aligulac.history.objects[l].rca?"Terran":"P"===e.aligulac.history.objects[l].rca?"Protoss":""},["icon"],historyEl);let a=document.createTextNode(`${e.aligulac.history.objects[l].sca}Â Â Â Â Â Â ${e.aligulac.history.objects[l].scb}`);historyEl.appendChild(a),createEl("img","",{src:`https://starcraftvods.com/images/${e.aligulac.history.objects[l].rcb}.png`,title:"Z"===e.aligulac.history.objects[l].rcb?"Zerg":"T"===e.aligulac.history.objects[l].rcb?"Terran":"P"===e.aligulac.history.objects[l].rcb?"Protoss":""},["icon"],historyEl),t=document.createTextNode(e.aligulac.history.objects[l].plb.tag),historyEl.appendChild(t),createEl("br","",null,[],historyEl),createEl("br","",null,[],historyEl)}e.aligulac.history.objects.length>4&&(history+=`...truncated...<br><a href="http://aligulac.com/results/search/?search=&players=${e.aligulac.history.objects[0].pla.tag}+${e.aligulac.history.objects[0].pla.id}%0D%0A${e.aligulac.history.objects[0].plb.tag}+${e.aligulac.history.objects[0].plb.id}&event=&bestof=all&offline=both&game=all" rel="noopener noreferrer" target="_blank">Click here for full history.</a>`)}}else loadingEl.textContent="Stream OFFLINE"},update=async function(){let e={method:"GET",cache:"no-cache",mode:"cors",headers:{"X-SCVODEXT":"true"},referrerPolicy:"no-referrer"};fetch("https://starcraftvods.com/data/stream.json",e).then(e=>e.json()).then(e=>{updatePanel(e)}).catch(e=>{updatePanel({error:e})})},createEl=function(e,l,t,r,o,i=!1){let n=document.createElement(e);if(n.textContent=l,r.length>0)for(let e=0;e<r.length;e++)n.classList.add(r[e]);if(null!==t)for(a in t)n.setAttribute(a,t[a]);i?o.prepend(n):o.appendChild(n)};window.addEventListener("DOMContentLoaded",e=>{chrome.storage.sync.get(e=>{console.log(e.options),e.options?(!Boolean(e.options.playerInfo)&&playerEl.forEach(e=>e.style.display="none"),!Boolean(e.options.thumbnail)&&(thumbnailEl.style.display="none"),!Boolean(e.options.aligulac)&&(document.querySelector(".item.history").style.display="none")):(options={thumbnail:!0,aligulac:!0,playerInfo:!0},chrome.storage.sync.set({options:options}))}),update()}),document.querySelector("#options").addEventListener("click",()=>{chrome.runtime.openOptionsPage?chrome.runtime.openOptionsPage():window.open(chrome.runtime.getURL("options.html"))});